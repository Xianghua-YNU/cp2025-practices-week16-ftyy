# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：**滕欣玥

**学号：**20221050199

**完成日期：** 2025.6.11

## 1. 实验目的

通过实现显式差分法求解一维热传导方程，掌握偏微分方程数值解法的基本原理，深入理解显式差分法的稳定性条件和精度特点，学会分析数值方法的误差和稳定性。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率， $C$ 是比热容， $\rho$ 是密度

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

显式差分法是一种常用的偏微分方程数值解法，其基本思想是用有限差分近似替代导数，将连续的时间和空间变量离散化，从而将偏微分方程转化为代数方程组，逐步推进解的演化。

对于一维热传导方程： $$ \frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial x^2} $$

离散化过程如下：

空间离散化：
将空间区间 $[0, L]$ 划分为 $N_x$ 个节点，步长为 $\Delta x$，第 $i$ 个节点的位置为 $x_i = i\Delta x$。

时间离散化：
将时间轴划分为 $N_t$ 个时刻，步长为 $\Delta t$，第 $n$ 个时刻为 $t_n = n\Delta t$。

差分近似：

时间导数用前向差分近似：
$$ \frac{\partial T}{\partial t} \approx \frac{T_i^{n+1} - T_i^n}{\Delta t} $$
空间二阶导数用中心差分近似：
$$ \frac{\partial^2 T}{\partial x^2} \approx \frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\Delta x)^2} $$
离散化后的迭代格式：
$$ T_i^{n+1} = T_i^n + r \left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \right) $$ 其中 $r = D \frac{\Delta t}{(\Delta x)^2}$。

稳定性条件：

显式差分法的稳定性依赖于参数 $r$。只有当 $r \leq 0.5$ 时，数值解才是稳定的，否则会出现数值振荡甚至发散。因此，空间步长和时间步长的选择必须满足： $$ r = D \frac{\Delta t}{(\Delta x)^2} \leq 0.5 $$

### 2.2 关键代码片段
```python
def basic_heat_diffusion():
    """
    任务1: 基本热传导模拟
    
    返回:
        np.ndarray: 温度分布数组
    """
    r = D * dt / dx**2# 稳定性参数
    print(f"[任务1] 稳定性参数 r = {r:.4f}")
    u = np.zeros((Nx, Nt))# 创建温度数组，初始全为0
    u[1:-1, 0] = 100.0  # 设置初始条件，内部点温度为100K
    for n in range(Nt-1):# 时间步循环
        # 显式有限差分法更新内部点温度
        u[1:-1, n+1] = (1-2*r)*u[1:-1, n] + r*(u[2:, n] + u[:-2, n])
        u[0, n+1] = 0.0# 左端边界条件
        u[-1, n+1] = 0.0# 右端边界条件
    return u # 返回温度分布数组
```

## 3. 实验结果

### 3.1 显式差分法数值解

![image](https://github.com/user-attachments/assets/d1712225-aafa-4ef3-8d78-9d690a838ef6)


### 3.2 解析解
**解析解公式：**

$$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin(k_nx)e^{-k_n^2Dt}$$

其中 $k_n = n\pi/L$， $T_0=100$ K

![image](https://github.com/user-attachments/assets/4b51ced6-864c-42b7-a9fc-e52f63716c36)


### 3.3 稳定性分析

**稳定性条件：** r = DΔt/Δx² ≤ 0.5

分析不同 $r$ 值下的数值解行为，展示稳定和不稳定情况的对比

[不稳定情况的温度分布的3D图]
![image](https://github.com/user-attachments/assets/e6935d91-f572-46e7-ad22-4f0fcccd934a)

[稳定情况的温度分布的3D图]
![image](https://github.com/user-attachments/assets/40dc1abb-ca16-498b-afa9-237f5a71da49)




### 3.4 不同初始条件模拟

[展示分段初始条件下的温度分布随时间位置演化的3D图]
![image](https://github.com/user-attachments/assets/02bde3b3-6e07-4e8a-a6eb-109f0e5da794)



### 3.5 包含牛顿冷却定律的模拟

[展示包含牛顿冷却定律的温度分布随时间位置演化的3D图]
![image](https://github.com/user-attachments/assets/650d5814-6cd1-42c1-84f4-b91f94aa921f)


## 4. 分析与讨论

1. **稳定性问题：**
  
   在实现显式差分法时，最大的稳定性问题是参数 $r = D\Delta t/\Delta x^2$ 必须满足 $r \leq 0.5$。如果 $r$ 超过0.5，数值解会出现非物理的振荡甚至发散，导致结果完全失真。因此，必须合理选择时间步长和空间步长，保证稳定性条件被满足。在实际编程过程中，如果不注意这一点，容易出现温度值异常增大或变为负数的现象。


2. **精度问题：**
  
   显式差分法的精度受限于空间和时间步长的选择。步长越大，截断误差越大，数值解与解析解的偏差也越大。为了获得更高的精度，需要减小 $\Delta x$ 和 $\Delta t$，但这会显著增加计算量和运行时间。此外，边界条件和初始条件的离散化也会带来误差。改进方法包括采用更高阶的差分格式、减小步长，或者使用隐式差分法等更稳定且允许更大步长的数值方法。

## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**
  
   当 $r = D\Delta t/\Delta x^2 > 0.5$ 时，显式差分格式的系数会导致新一时刻的温度值对前一时刻的扰动产生放大效应。这样，数值误差会在迭代过程中不断累积和放大，最终导致解出现非物理的振荡甚至发散。这是因为差分格式的稳定性分析（如Von Neumann分析）表明，只有 $r \leq 0.5$ 时所有的傅里叶模都不会被放大，数值解才是稳定的。

2. **如何从物理角度理解稳定性条件的含义？**
  
   从物理角度看，$r \leq 0.5$ 要求每一步时间推进时，热量的扩散不能“跳过”相邻的格点，否则会导致信息传播过快，违背实际物理过程。这个条件保证了热量在每个时间步内的扩散是局部的、连续的，符合真实的热传导过程。如果 $r$ 太大，数值方法模拟的热扩散速度超过了物理允许的范围，导致解不再可信。
